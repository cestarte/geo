@page "/map"
@* @rendermode @(new InteractiveWebAssemblyRenderMode(prerender: false)) *@
@rendermode @(new InteractiveServerRenderMode(prerender: false))
@using LMap.Client.JSInterop

@inject IJSRuntime JSRuntime
@inject LMap.Client.JSInterop.MapJSInterop MapJS

<script src="./leaflet-1.9.4/leaflet.js"></script>
<link href="./leaflet-1.9.4/leaflet.css" rel="stylesheet" />

<div>Markers placed: @NumMarkers</div>
<div @ref="mapContainer" style="width: 100%; height: 80%;"></div>

<button @onclick="@(() => AddMarker(51.505, -0.09, "Marker 1"))">Add Marker 1</button>

@code {
    private ElementReference mapContainer;
    public int NumMarkers { get; set; } = 0;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await InitializeMap();
        }
    }

    public async Task InitializeMap()
    {
        // Assuming you have a JavaScript function to initialize the map
        await MapJS.InitMap(mapContainer);
    }

    public async Task AddMarker(double lat, double lng, string title)
    {
        await MapJS.AddMarker(lat, lng, title);
        NumMarkers++;
        //StateHasChanged(); // Refresh the UI to show the updated marker count
    }
}
